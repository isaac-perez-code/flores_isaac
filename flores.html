<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flores y Música</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Roboto&display=swap');

    body {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #f9e2e7 0%, #fad0c4 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      color: #7b2ff7;
      overflow-x: hidden;
      text-align: center;
      padding: 20px;
      transition: background 0.6s ease;
      background-size: cover;
      background-position: center;
      position: relative; /* para los pétalos */
    }

    /* Fondo personalizado cuando se abre la carta */
    body.carta-abierta {
      background-image: url('img_port.jpeg'); /* Cambia aquí por tu imagen */
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center center;
      filter: brightness(0.85);
      color: #fff;
    }

    h1 {
      font-family: 'Great Vibes', cursive;
      font-size: 3rem;
      margin-bottom: 20px;
      color: #d6336c;
      text-shadow: 1px 1px 4px #fce4ec;
    }

    .message-box {
      background: rgba(255, 255, 255, 0.75);
      border-radius: 15px;
      padding: 25px 30px;
      margin: 15px;
      max-width: 400px;
      box-shadow: 0 8px 20px rgba(219, 112, 147, 0.25);
      font-size: 1.25rem;
      font-style: italic;
      color: #b34a6b;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 1s forwards;
    }

    .message-box:nth-child(2) {
      animation-delay: 0.7s;
    }
    .message-box:nth-child(3) {
      animation-delay: 1.4s;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Ocultar audio */
    audio {
      display: none;
    }

    /* Botones */
    .btn {
      margin: 15px 10px 30px;
      background-color: #d6336c;
      color: white;
      border: none;
      padding: 12px 30px;
      font-size: 1.1rem;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(214, 51, 108, 0.4);
      transition: background-color 0.3s ease;
      user-select: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .btn:hover {
      background-color: #b3335c;
    }
    .btn a {
      color: white;
      text-decoration: none;
    }

    /* Carta emergente */
    .carta {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      background: rgba(255, 240, 246, 0.95);
      border: 3px solid #d6336c;
      border-radius: 25px;
      padding: 30px 40px;
      max-width: 500px;
      box-shadow: 0 12px 30px rgba(214, 51, 108, 0.6);
      color: #a02a56;
      font-size: 1.2rem;
      line-height: 1.6;
      font-family: 'Roboto', sans-serif;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s ease;
      z-index: 9999;
      overflow-y: auto;
      max-height: 80vh;
    }

    .carta.show {
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -50%) scale(1);
    }

    .carta h2 {
      font-family: 'Great Vibes', cursive;
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: #d6336c;
      text-align: center;
    }

    .carta p {
      margin-bottom: 15px;
      font-style: normal;
      color: #7b2f57;
      min-height: 1.5em; /* para que no salte mientras se escribe */
      white-space: pre-wrap;
    }

    .btn-cerrar {
      display: block;
      margin: 25px auto 0;
      background-color: #7b2f57;
      border: none;
      color: white;
      padding: 10px 25px;
      font-size: 1rem;
      border-radius: 20px;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(123, 47, 87, 0.7);
      transition: background-color 0.3s ease;
      user-select: none;
    }
    .btn-cerrar:hover {
      background-color: #5a2041;
    }

    /* ======= NUEVAS FUNCIONES ======= */

    /* Pétalos y corazones que caen */
    .petalos-container, .corazones-container {
      pointer-events: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      z-index: 0;
    }

    .petalo, .corazon-cae {
      position: absolute;
      opacity: 0.9;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }

    .petalo {
      width: 25px;
      height: 25px;
      background: url('https://i.imgur.com/k4vD5Kw.png') no-repeat center center;
      background-size: contain;
      animation-name: caer;
    }

    .corazon-cae {
      width: 20px;
      height: 20px;
      background: url('https://i.imgur.com/RGq9aYk.png') no-repeat center center;
      background-size: contain;
      animation-name: caer;
    }

    @keyframes caer {
      0% {
        transform: translateY(-40px) rotate(0deg);
        opacity: 0.9;
      }
      100% {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* Nombres juntos animados */
    .nombres {
      font-family: 'Great Vibes', cursive;
      font-size: 2.5rem;
      color: #d6336c;
      margin-top: 10px;
      user-select: none;
      animation: pulso 2s ease-in-out infinite;
      text-shadow: 0 0 10px #ff8fb1;
    }

    @keyframes pulso {
      0%, 100% {
        text-shadow: 0 0 10px #ff8fb1;
        color: #d6336c;
      }
      50% {
        text-shadow: 0 0 20px #ff3366;
        color: #ff3366;
      }
    }

    /* Corazón animado que late en botón */
    .btn .corazon {
      width: 24px;
      height: 24px;
      margin-left: 10px;
      fill: #ff4d86;
      animation: latido 1.2s infinite;
    }

    @keyframes latido {
      0%, 100% { transform: scale(1);}
      50% { transform: scale(1.3);}
    }

    /* Caja mensajes extra con stickers */
    .extra-messages {
      margin-top: 30px;
      max-width: 420px;
      color: #a03458;
    }

    .extra-messages .msg {
      background: #ffe6f0;
      border: 2px solid #d6336c;
      border-radius: 20px;
      padding: 15px 20px;
      margin: 15px 0;
      font-size: 1.1rem;
      box-shadow: 0 4px 10px #f2c7d6;
      position: relative;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .extra-messages .msg .sticker {
      font-size: 2rem;
      user-select: none;
      animation: flotar 3s ease-in-out infinite alternate;
    }

    @keyframes flotar {
      0% { transform: translateY(0); }
      100% { transform: translateY(-12px); }
    }

    /* ===== NUEVAS FUNCIONALIDADES ===== */
    
    /* Contador de tiempo juntos */
    .contador-tiempo {
      background: rgba(255, 255, 255, 0.8);
      border-radius: 15px;
      padding: 15px 25px;
      margin: 20px 0;
      box-shadow: 0 4px 15px rgba(219, 112, 147, 0.3);
      font-size: 1.1rem;
      color: #b34a6b;
      font-weight: 600;
    }
    
    .contador-tiempo span {
      color: #d6336c;
      font-weight: bold;
    }
    
    /* Botón secreto de sorpresa */
    .btn-secreto {
      margin-top: 20px;
      background: transparent;
      border: 2px dashed #d6336c;
      color: #d6336c;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }
    
    .btn-secreto:hover {
      background: rgba(214, 51, 108, 0.1);
    }
    
    /* Galería de fotos */
    .galeria {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
      max-width: 500px;
    }
    
    .foto {
      width: 120px;
      height: 120px;
      border-radius: 15px;
      object-fit: cover;
      border: 3px solid #d6336c;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    
    .foto:hover {
      transform: scale(1.05);
    }
    
    /* Modal para fotos */
    .modal-foto {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    
    .modal-foto.mostrar {
      opacity: 1;
      pointer-events: auto;
    }
    
    .modal-foto img {
      max-width: 90%;
      max-height: 90%;
      border-radius: 10px;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
    }
    
    .btn-cerrar-modal {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* Efecto de confeti */
    .confeti {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: #f00;
      opacity: 0.7;
      z-index: 1000;
      animation: caerConfeti 5s linear forwards;
    }
    
    @keyframes caerConfeti {
      0% {
        transform: translateY(-10px) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }
    
    /* Botón de música */
    .btn-musica {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.8);
      border: 2px solid #d6336c;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    
    .btn-musica svg {
      width: 24px;
      height: 24px;
      fill: #d6336c;
    }
    
    /* Mensaje flotante */
    .mensaje-flotante {
      position: fixed;
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid #d6336c;
      border-radius: 15px;
      padding: 15px;
      max-width: 250px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
      pointer-events: none;
    }
    
    .mensaje-flotante.mostrar {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>
  <h1>Para ti, con todo mi corazón</h1>

  <div class="message-box">"Cada flor es un suspiro del alma que te dedico."</div>
  <div class="message-box">"Tu sonrisa es el sol que ilumina mis días más grises."</div>
  <div class="message-box">"Amarte es el regalo más dulce y sincero que la vida me ha dado."</div>

  <!-- Contador de tiempo juntos -->
  <div class="contador-tiempo">
    Llevamos juntos: <span id="tiempoJuntos">0 días, 0 horas, 0 minutos</span>
  </div>

  <div>
    <button class="btn" id="btnRegresar"><a href="index.html">Regresar</a></button>
    <button class="btn" id="btnAbrirCarta">Abre mi corazón
      <svg class="corazon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
    </button>
  </div>

  <!-- Galería de fotos -->
  <div class="galeria" id="galeriaFotos">
    <!-- Las fotos se agregarán dinámicamente con JavaScript -->
  </div>

  <!-- Nombres animados -->
  <div class="nombres" aria-label="Isaac y Yamileth juntos">Isaac ❤️ Yami</div>

  <!-- Mensajes extras con stickers -->
  <div class="extra-messages">
    <div class="msg"><span class="sticker">🌹</span> Yamileth, cada momento contigo es un poema que quiero escribir toda mi vida.</div>
    <div class="msg"><span class="sticker">🎶</span> Tus ojos son la melodía que alegra mis días más grises.</div>
    <div class="msg"><span class="sticker">💌</span> Mi amor por ti crece con cada latido del corazón.</div>
  </div>

  <!-- Botón secreto -->
  <button class="btn-secreto" id="btnSecreto">✨ Haz clic para una sorpresa ✨</button>

  <!-- Botón de música -->
  <div class="btn-musica" id="btnMusica">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
    </svg>
  </div>

  <audio id="miAudio" autoplay loop>
    <source src="Noel Schajris - No Veo La Hora.mp3" type="audio/mp3" />
    Tu navegador no soporta el elemento de audio.
  </audio>

  <!-- Carta emergente -->
  <div class="carta" id="cartaMensaje" aria-hidden="true">
    <h2>Mi corazón abierto para ti</h2>
    <p id="line1"></p>
    <p id="line2"></p>
    <p id="line3"></p>
    <p id="line4"></p>
    <p id="line5"></p>
    <button class="btn-cerrar" id="btnCerrarCarta">Cerrar</button>
  </div>

  <!-- Modal para fotos -->
  <div class="modal-foto" id="modalFoto">
    <button class="btn-cerrar-modal" id="btnCerrarModal">×</button>
    <img id="fotoAmpliada" src="" alt="Foto ampliada">
  </div>

  <!-- Mensaje flotante -->
  <div class="mensaje-flotante" id="mensajeFlotante"></div>

  <!-- Contenedor pétalos -->
  <div class="petalos-container" aria-hidden="true"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const audio = document.getElementById('miAudio');
      const btnMusica = document.getElementById('btnMusica');
      let audioReproduciendo = true;
      
      // Reproducir audio
      audio.play().catch(err => {
        console.warn('Autoplay falló:', err);
        document.body.addEventListener('click', () => {
          audio.play().catch(e => console.warn('Reproducción después del clic falló:', e));
        }, { once: true });
      });
      
      // Control de música
      btnMusica.addEventListener('click', () => {
        if (audioReproduciendo) {
          audio.pause();
          btnMusica.style.opacity = '0.5';
        } else {
          audio.play();
          btnMusica.style.opacity = '1';
        }
        audioReproduciendo = !audioReproduciendo;
      });

      const btnAbrirCarta = document.getElementById('btnAbrirCarta');
      const carta = document.getElementById('cartaMensaje');
      const btnCerrarCarta = document.getElementById('btnCerrarCarta');
      const body = document.body;

      // Textos para la carta
      const textos = [
        "Amor mío, sé que cometí muchos errores y quiero que sepas que cada uno me duele profundamente.",
        "Me arrepiento sinceramente y deseo comenzar de nuevo, construir un futuro donde solo haya amor, respeto y comprensión entre nosotros.",
        "Sin ti, nada tiene sentido ni brillo, eres mi luz, mi compañera, mi todo.",
        "Quiero que seas mi compañera de vida, para esta y todas las vidas que vengan.",
        "Te amo con toda el alma, y lucharé cada día por recuperar tu corazón y hacerte feliz."
      ];

      // Párrafos donde escribiremos
      const parrafos = textos.map((_, i) => document.getElementById(`line${i + 1}`));

      // Función máquina de escribir para un párrafo
      function escribirTexto(element, texto, delay = 30) {
        return new Promise(resolve => {
          element.textContent = '';
          let i = 0;
          const escribir = () => {
            if (i < texto.length) {
              element.textContent += texto.charAt(i);
              i++;
              setTimeout(escribir, delay);
            } else {
              resolve();
            }
          };
          escribir();
        });
      }

      async function escribirCarta() {
        for (let i = 0; i < textos.length; i++) {
          await escribirTexto(parrafos[i], textos[i], 30);
          await new Promise(r => setTimeout(r, 400));
        }
      }

      btnAbrirCarta.addEventListener('click', () => {
        carta.classList.add('show');
        carta.setAttribute('aria-hidden', 'false');
        body.classList.add('carta-abierta');
        // Limpiar textos y comenzar a escribir
        parrafos.forEach(p => p.textContent = '');
        escribirCarta();
      });

      btnCerrarCarta.addEventListener('click', () => {
        carta.classList.remove('show');
        carta.setAttribute('aria-hidden', 'true');
        body.classList.remove('carta-abierta');
      });

      // ===== PÉTALOS QUE CAEN =====

      const petalosContainer = document.querySelector('.petalos-container');

      function crearPetalo() {
        const petalo = document.createElement('div');
        petalo.classList.add('petalo');
        // Posición horizontal aleatoria
        petalo.style.left = Math.random() * 100 + 'vw';
        // Duración animación aleatoria (8 a 14 segundos)
        petalo.style.animationDuration = (8 + Math.random() * 6) + 's';
        // Tamaño aleatorio
        const size = 15 + Math.random() * 20;
        petalo.style.width = size + 'px';
        petalo.style.height = size + 'px';
        // Delay para que no todos caigan al mismo tiempo
        petalo.style.animationDelay = (Math.random() * 10) + 's';

        petalosContainer.appendChild(petalo);

        // Remover pétalo después que cae para no saturar DOM
        setTimeout(() => {
          petalo.remove();
        }, (parseFloat(petalo.style.animationDuration) + parseFloat(petalo.style.animationDelay)) * 1000);
      }

      // Crear pétalos cada 500ms
      setInterval(crearPetalo, 500);

      // ===== NUEVAS FUNCIONALIDADES =====
      
      // Contador de tiempo juntos
      const tiempoJuntos = document.getElementById('tiempoJuntos');
      const fechaInicio = new Date('2023-01-01'); // Cambia esta fecha por la real
      
      function actualizarContador() {
        const ahora = new Date();
        const diferencia = ahora - fechaInicio;
        
        const dias = Math.floor(diferencia / (1000 * 60 * 60 * 24));
        const horas = Math.floor((diferencia % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutos = Math.floor((diferencia % (1000 * 60 * 60)) / (1000 * 60));
        
        tiempoJuntos.textContent = `${dias} días, ${horas} horas, ${minutos} minutos`;
      }
      
      // Actualizar contador cada minuto
      actualizarContador();
      setInterval(actualizarContador, 60000);
      
      // Galería de fotos
      const galeriaFotos = document.getElementById('galeriaFotos');
      const modalFoto = document.getElementById('modalFoto');
      const fotoAmpliada = document.getElementById('fotoAmpliada');
      const btnCerrarModal = document.getElementById('btnCerrarModal');
      
      // URLs de ejemplo para las fotos (reemplaza con tus propias imágenes)
      const fotos = [
        'img_port.jpeg',
        '2.jpeg',
        '1.jpeg',
      ];
      
      // Crear elementos de foto
      fotos.forEach((foto, index) => {
        const img = document.createElement('img');
        img.src = foto;
        img.alt = `Nuestra foto ${index + 1}`;
        img.classList.add('foto');
        img.addEventListener('click', () => {
          fotoAmpliada.src = foto;
          modalFoto.classList.add('mostrar');
        });
        galeriaFotos.appendChild(img);
      });
      
      // Cerrar modal de foto
      btnCerrarModal.addEventListener('click', () => {
        modalFoto.classList.remove('mostrar');
      });
      
      modalFoto.addEventListener('click', (e) => {
        if (e.target === modalFoto) {
          modalFoto.classList.remove('mostrar');
        }
      });
      
      // Botón secreto
      const btnSecreto = document.getElementById('btnSecreto');
      const mensajeFlotante = document.getElementById('mensajeFlotante');
      
      btnSecreto.addEventListener('click', () => {
        // Crear confeti
        crearConfeti();
        
        // Mostrar mensaje flotante
        const mensajes = [
          "¡Eres la persona más especial de mi vida!",
          "Cada día a tu lado es un regalo",
          "Tu sonrisa ilumina mi mundo",
          "Te amo más de lo que las palabras pueden expresar",
          "Eres mi sueño hecho realidad"
        ];
        
        const mensajeAleatorio = mensajes[Math.floor(Math.random() * mensajes.length)];
        mensajeFlotante.textContent = mensajeAleatorio;
        mensajeFlotante.classList.add('mostrar');
        
        // Posicionar mensaje cerca del botón
        const rect = btnSecreto.getBoundingClientRect();
        mensajeFlotante.style.left = `${rect.left}px`;
        mensajeFlotante.style.top = `${rect.top - 100}px`;
        
        // Ocultar mensaje después de 3 segundos
        setTimeout(() => {
          mensajeFlotante.classList.remove('mostrar');
        }, 3000);
      });
      
      // Función para crear confeti
      function crearConfeti() {
        const colores = ['#ff3366', '#ff6699', '#ff9966', '#ffcc66', '#66ccff', '#9966ff'];
        
        for (let i = 0; i < 50; i++) {
          const confeti = document.createElement('div');
          confeti.classList.add('confeti');
          confeti.style.left = Math.random() * 100 + 'vw';
          confeti.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
          confeti.style.width = (5 + Math.random() * 10) + 'px';
          confeti.style.height = (5 + Math.random() * 10) + 'px';
          confeti.style.animationDuration = (3 + Math.random() * 3) + 's';
          confeti.style.animationDelay = (Math.random() * 2) + 's';
          
          document.body.appendChild(confeti);
          
          // Remover confeti después de la animación
          setTimeout(() => {
            confeti.remove();
          }, 6000);
        }
      }
    });
  </script>
</body>
</html>
